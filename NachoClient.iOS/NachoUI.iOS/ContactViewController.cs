// This file has been autogenerated from a class added in the UI designer.

using System;
using MonoTouch.Foundation;
using MonoTouch.UIKit;
using NachoCore.Model;
using MonoTouch.Dialog;
using NachoCore.ActiveSync;

namespace NachoClient.iOS
{
    public partial class ContactViewController : DialogViewController
    {
        public NcContact contact;

        public ContactViewController (IntPtr handle) : base (handle)
        {
        }

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();

            // Handle button press
            NavigationItem.RightBarButtonItem.Clicked += (object sender, EventArgs e) => {
                Console.WriteLine ("ContactViewController editBarButtonItem pressed");
            };

            // Set up view
            Pushing = true;
            if (null == contact) {
                Root = new RootElement ("New Contact") { new Section () };
                NavigationItem.RightBarButtonItem = null;
            } else {
                Root = ToDialogElement (contact);
                NavigationItem.RightBarButtonItem.Enabled = true;
            }
        }

        public void AddIfSet (ref Section section, string name, string value)
        {
            if (null != value) {
                section.Add (new StringElement (name, value));
            }
        }

        public void AddIfSet (ref Section section, string name, DateTime value)
        {
            if (!NcContact.IsNull (value)) {
                section.Add (new DateTimeElement (name, value));
            }
        }

        public void AddIfSet (ref Section section, string name, int value)
        {
            if (!NcContact.IsNull (value)) {
                section.Add (new StringElement (name, value.ToString()));
            }
        }

        public RootElement ToDialogElement (NcContact c)
        {
            System.Diagnostics.Trace.Assert (null != c);

            var section = new Section ();

            // Person
            AddIfSet (ref section, "Title", c.Title);
            AddIfSet (ref section, "First name", c.FirstName);
            AddIfSet (ref section, "Middle name", c.MiddleName);
            AddIfSet (ref section, "Last name", c.LastName);
            AddIfSet (ref section, "Suffix", c.Suffix);
            AddIfSet (ref section, "Nickname", c.NickName);
            AddIfSet (ref section, "Job title", c.JobTitle);

            AddIfSet (ref section, "Alias", c.Alias);
            AddIfSet (ref section, "File As", c.FileAs);
            AddIfSet (ref section, "Account Name", c.AccountName);
            AddIfSet (ref section, "Customer Id", c.CustomerId);
            AddIfSet (ref section, "Government Id", c.GovernmentId);

            // Business Phone number stuff
            AddIfSet (ref section, "Business phone number", c.BusinessPhoneNumber);
            AddIfSet (ref section, "Business phone number", c.Business2PhoneNumber);
            AddIfSet (ref section, "Business fax number", c.BusinessFaxNumber);
            AddIfSet (ref section, "Mobile phone number", c.MobilePhoneNumber);
            AddIfSet (ref section, "Radio phone number", c.RadioPhoneNumber);
            AddIfSet (ref section, "Pager number", c.PagerNumber);
            AddIfSet (ref section, "MMS number", c.MMS);

            // Email addresses
            AddIfSet (ref section, "Email", c.Email1Address);
            AddIfSet (ref section, "Email", c.Email2Address);
            AddIfSet (ref section, "Email", c.Email3Address);

            // IM
            AddIfSet (ref section, "IM Address", c.IMAddress);
            AddIfSet (ref section, "IM Address", c.IMAddress2);
            AddIfSet (ref section, "IM Address", c.IMAddress3);

            AddIfSet (ref section, "Web page", c.WebPage);

            // Others at work
            AddIfSet (ref section, "Manager name", c.ManagerName);
            AddIfSet (ref section, "Assistant name", c.AssistantName);
            AddIfSet (ref section, "Assistant phone number", c.AssistantPhoneNumber);

            // Company stuff
            AddIfSet (ref section, "Company name", c.CompanyName);
            AddIfSet (ref section, "Department name", c.Department);
            AddIfSet (ref section, "Office location", c.OfficeLocation);
            AddIfSet (ref section, "Company phone number", c.CompanyMainPhone);

            Section businessAddress = new Section ("Business Address");
            AddIfSet (ref businessAddress, "Street", c.BusinessAddressStreet);
            AddIfSet (ref businessAddress, "City", c.BusinessAddressCity);
            AddIfSet (ref businessAddress, "State", c.BusinessAddressState);
            AddIfSet (ref businessAddress, "Country", c.BusinessAddressCountry);
            AddIfSet (ref businessAddress, "Postal code", c.BusinessAddressPostalCode);
            if (businessAddress.Count > 0) {
                section.Add (businessAddress);
            }

            // Home stuff
            AddIfSet (ref section, "Home phone number", c.HomePhoneNumber);
            AddIfSet (ref section, "Home phone number", c.Home2PhoneNumber);
            AddIfSet (ref section, "Home fax number", c.HomeFaxNumber);

            Section homeAddress = new Section ("Home Address");
            AddIfSet (ref homeAddress, "Street", c.HomeAddressStreet);
            AddIfSet (ref homeAddress, "City", c.HomeAddressCity);
            AddIfSet (ref homeAddress, "State", c.HomeAddressState);
            AddIfSet (ref homeAddress, "Country", c.HomeAddressCountry);
            AddIfSet (ref homeAddress, "Postal code", c.HomeAddressPostalCode);
            if (homeAddress.Count > 0) {
                section.Add (homeAddress);
            }

            // Personal
            AddIfSet (ref section, "Birthday", c.Birthday);
            AddIfSet (ref section, "Spouse", c.Spouse);
            AddIfSet (ref section, "Anniversary", c.Anniversary);

            Section otherAddress = new Section ("Other Address");
            AddIfSet (ref otherAddress, "Street", c.OtherAddressStreet);
            AddIfSet (ref otherAddress, "City", c.OtherAddressCity);
            AddIfSet (ref otherAddress, "State", c.OtherAddressState);
            AddIfSet (ref otherAddress, "Country", c.OtherAddressCountry);
            AddIfSet (ref otherAddress, "Postal code", c.OtherAddressPostalCode);
            if (otherAddress.Count > 0) {
                section.Add (otherAddress);
            }

            AddIfSet (ref section, "Weighted rank", c.WeightedRank);

            // Unhandled
//            public List<NcContactCategory> categories;
//            public string Children { get; set; }
//            public string Picture { get; set; }
//            public string WebPage { get; set; }
//            public string YomiFirstName { get; set; }
//            public string YomiLastName { get; set; }
//            public string YomiCompanyName { get; set; }

            // Finish up
            var root = new RootElement (c.GetDisplayName());
            root.Add (section);
            return root;
        }
    }
}
