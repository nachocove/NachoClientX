// This file has been autogenerated from a class added in the UI designer.

using System;

using MonoTouch.Foundation;
using MonoTouch.UIKit;
using NachoCore;
using NachoCore.Model;

namespace NachoClient.iOS
{
	public partial class ReadMsgController : UIViewController
	{
		AppDelegate appDelegate { get; set; }
		NcEmailMessage currentMessage { get; set; }

		public void SetMessage (NcEmailMessage ncemailmsg) {
			currentMessage = ncemailmsg;
		}

		public override void PrepareForSegue (UIStoryboardSegue segue, NSObject sender)
		{
			base.PrepareForSegue (segue, sender);
			NcEmailMessage thisemailmsg;

			if (segue.Identifier == "replymessagesegue" ){
				var replymsg = (ReplyViewController)segue.DestinationViewController; //our destination



				replymsg.SetMessage(currentMessage);
			};
		}

		public override void ViewDidLoad ()
		{
			string contentDirectoryPath = "here/";
			base.ViewDidLoad ();
			// need to see senders NcEname
			var webView = new UIWebView (View.Bounds);
			View.AddSubview(webView);
			Console.Write ("Display Email :");
			Console.WriteLine (currentMessage.From);
			Console.WriteLine (currentMessage.Body);
			Console.WriteLine("< EOM >");


			webView.LoadHtmlString(currentMessage.Body, new NSUrl(contentDirectoryPath, false));

		}
		partial void btnReplyMessage (MonoTouch.Foundation.NSObject sender){
			Console.WriteLine("Reply Button Pushed");
		}

		public ReadMsgController (IntPtr handle) : base (handle)
		{
		
			appDelegate = (AppDelegate)UIApplication.SharedApplication.Delegate;

		}
	}
}
