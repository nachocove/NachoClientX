// This file has been autogenerated from a class added in the UI designer.

using System;

using Foundation;
using UIKit;

using System.IO;
using CoreGraphics;
using System.Collections.Generic;

namespace NachoClient.iOS
{
    public partial class PhoneViewController : NcUIViewController
    {
        public string Phone;

        UIView phoneView;
        UITextField phoneField;
        //UIView phoneResultsView;

        UIButton myNumberButton;
        UIButton myConferenceButton;

        UIColor separatorColor = A.Color_NachoBorderGray;
        protected static nfloat SCREEN_WIDTH = UIScreen.MainScreen.Bounds.Width;
        protected int LINE_OFFSET = 30;
        protected int CELL_HEIGHT = 44;
        protected int NAV_BAR_HEIGHT = 44;
        protected int STATUS_BAR_HEIGHT = 20;
        protected int PHONE_OFFSET = 0;
        //        protected int START_PICKER_HEIGHT = 0;
        //        protected int END_PICKER_HEIGHT = 0;
        protected nfloat TEXT_LINE_HEIGHT = 19.124f;
        //        protected float DESCRIPTION_OFFSET = 0f;
        //        protected bool suppressLayout = false;
        //        protected bool startDateOpen = false;
        //        protected bool endDateOpen = false;
        //        protected bool startIsOpening = false;
        //        protected bool endIsOpening = false;

        protected UIView line1;
        protected UIView line2;
        protected UIView line3;
        protected UIView line4;
       
        protected UIView phoneDivider;
        protected UIView conferenceDivider;

        const int ALL_DAY_SWITCH_TAG = 200;
        const int START_DATE_TAG = 201;
        const int END_DATE_TAG = 202;
        const int LOCATION_DETAIL_TAG = 203;
        const int PHONE_DETAIL_TAG = 204;
        const int ATTACHMENTS_DETAIL_TAG = 205;
        const int PEOPLE_DETAIL_TAG = 206;
        const int ALERT_DETAIL_TAG = 207;
        const int CAL_DETAIL_TAG = 210;
        UIColor solidTextColor = A.Color_NachoBlack;

        public PhoneViewController () : base ()
        {
        }


        public PhoneViewController (IntPtr handle) : base (handle)
        {
        }

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();


            doneButton.Clicked += (object sender, EventArgs e) => {
                Phone = phoneField.Text;
                NavigationController.PopViewController (true);
            };

            doneButton.AccessibilityLabel = "Done";

            CreatePhoneView ();


        }

        public void SetPhone (string phone)
        {
            this.Phone = phone;

        }

        public string GetPhone ()
        {

            return this.Phone;
        }



        public override void ViewWillAppear (bool animated)
        {
            base.ViewWillAppear (animated);
            if (null != this.NavigationController) {
                this.NavigationController.ToolbarHidden = true;
            }

            //ConfigureEventView ();

        }

        protected void CreatePhoneView ()
        {
            myNumberButton = UIButton.FromType (UIButtonType.System);
            myNumberButton.Frame = new CGRect (0, LINE_OFFSET, SCREEN_WIDTH, CELL_HEIGHT);
            myNumberButton.Font = A.Font_AvenirNextRegular14;
            myNumberButton.SetTitle ("Use My Phone Number", UIControlState.Normal);
            myNumberButton.AccessibilityLabel = "Use my phone number";
            myNumberButton.SetTitleColor (solidTextColor, UIControlState.Normal);
            myNumberButton.BackgroundColor = UIColor.White;
            myNumberButton.TouchUpInside += (sender, e) => {
                Phone = "My phone number";
                NavigationController.PopViewController (true);
            };

            myConferenceButton = UIButton.FromType (UIButtonType.System);
            myConferenceButton.Frame = new CGRect (0, LINE_OFFSET + CELL_HEIGHT, SCREEN_WIDTH, CELL_HEIGHT);
            myConferenceButton.Font = A.Font_AvenirNextRegular14;
            myConferenceButton.SetTitle ("Use My Conference Call Number", UIControlState.Normal);
            myConferenceButton.AccessibilityLabel = "Use my conference call number";
            myConferenceButton.SetTitleColor (solidTextColor, UIControlState.Normal);
            myConferenceButton.BackgroundColor = UIColor.White;
            myConferenceButton.TouchUpInside += (sender, e) => {
                Phone = "My conference number";
                NavigationController.PopViewController (true);
            };

            //Phone Number
            phoneView = new UIView (new CGRect (0, (LINE_OFFSET * 2) + (CELL_HEIGHT * 2), SCREEN_WIDTH, CELL_HEIGHT));
            phoneView.BackgroundColor = UIColor.White;

            UIImageView phoneImage = new UIImageView (new CGRect (15, 14.5f, 15, 15));
            phoneImage.Image = UIImage.FromBundle ("icn-mtng-phone");
            phoneView.AddSubview (phoneImage);

            phoneField = new UITextField (new CGRect (LINE_OFFSET + 7, 12.438f, SCREEN_WIDTH - 52, TEXT_LINE_HEIGHT));
            phoneField.Font = A.Font_AvenirNextRegular14;
            phoneField.TextColor = A.Color_808080;
            phoneField.Placeholder = "Phone Number or Contact";
            phoneField.ClearButtonMode = UITextFieldViewMode.Always;

            phoneView.AddSubview (phoneField);

            phoneField.EditingDidBegin += (object sender, EventArgs e) => {
                UIView.Animate (.1, 0, UIViewAnimationOptions.CurveLinear,
                    () => {
                        myNumberButton.Alpha = 0;
                        myConferenceButton.Alpha = 0;
                        line1.Alpha = 0;
                        line2.Alpha = 0;
                    },
                    () => {
                        myNumberButton.Hidden = true;
                        myConferenceButton.Hidden = true;
                        line1.Hidden = true;
                        line2.Hidden = true;
                        NavigationItem.RightBarButtonItem = doneButton;
                    }
                );

                PHONE_OFFSET = -((CELL_HEIGHT * 2) + LINE_OFFSET);
                LayoutView ();
            };

  
            //Content View

            var bottom = phoneView.Frame.Bottom + LINE_OFFSET;
            contentView.Frame = new CGRect (0, 0, SCREEN_WIDTH, bottom + 100);
            contentView.BackgroundColor = A.Color_NachoNowBackground;
            contentView.AddSubviews (new UIView[] {
                myNumberButton,
                myConferenceButton,
                phoneView

            }); 
            //LO
            line1 = AddLine (0, LINE_OFFSET, SCREEN_WIDTH, separatorColor);
            line2 = AddLine (0, LINE_OFFSET + CELL_HEIGHT, SCREEN_WIDTH, separatorColor);
            line3 = AddLine (0, (LINE_OFFSET * 2) + (CELL_HEIGHT * 2), SCREEN_WIDTH, separatorColor);
            line4 = AddLine (0, (LINE_OFFSET * 2) + (CELL_HEIGHT * 3), SCREEN_WIDTH, separatorColor);

            contentView.AddSubviews (new UIView[] {
                line1,
                line2,
                line3,
                line4
            }); 

            //Scroll View
            scrollView.BackgroundColor = A.Color_NachoNowBackground;

            scrollView.ContentSize = contentView.Frame.Size;
            scrollView.KeyboardDismissMode = UIScrollViewKeyboardDismissMode.OnDrag;

        }

        protected void ConfigurePhoneView ()
        {


        }
            

        public UIView AddLine (nfloat offset, nfloat yVal, nfloat width, UIColor color)
        {
            var lineUIView = new UIView (new CGRect (offset, yVal, width, .5f));
            lineUIView.BackgroundColor = color;
            return (lineUIView);
        }


        protected void LayoutView ()
        {

            UIView.Animate (0.2, () => {

                phoneView.Frame = new CGRect (0, (LINE_OFFSET * 2) + (CELL_HEIGHT * 2) + PHONE_OFFSET, SCREEN_WIDTH, CELL_HEIGHT);
                //conferenceView.Frame = new RectangleF (0, (LINE_OFFSET * 2) + CELL_HEIGHT + CONFERENCE_OFFSET, SCREEN_WIDTH, CELL_HEIGHT);

//                line1.Frame = new RectangleF (0, LINE_OFFSET + (CELL_HEIGHT * 2) + TEXT_LINE_HEIGHT + DESCRIPTION_OFFSET, SCREEN_WIDTH, .5f);
//                line2.Frame = new RectangleF (0, (LINE_OFFSET * 2) + (CELL_HEIGHT * 2) + TEXT_LINE_HEIGHT + DESCRIPTION_OFFSET, SCREEN_WIDTH, .5f);
                line3.Frame = new CGRect (0, (LINE_OFFSET * 2) + (CELL_HEIGHT * 2) + PHONE_OFFSET, SCREEN_WIDTH, .5f);
                line4.Frame = new CGRect (0, (LINE_OFFSET * 2) + (CELL_HEIGHT * 3) + PHONE_OFFSET, SCREEN_WIDTH, .5f);

            },
                () => {

                });
            contentView.Frame = new CGRect (0, 0, SCREEN_WIDTH, (LINE_OFFSET * 2) + (CELL_HEIGHT * 3) + PHONE_OFFSET);
            scrollView.ContentSize = contentView.Frame.Size;
        }

    }
}