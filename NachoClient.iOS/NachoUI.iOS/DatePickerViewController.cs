// This file has been autogenerated from a class added in the UI designer.

using System;
using Foundation;
using UIKit;
using CoreGraphics;
using NachoClient.iOS;

namespace NachoClient.iOS
{
    public partial class DatePickerViewController : NcUIViewController
    {
        public INcDatePickerDelegate owner;
        UIButton cancelButton;
        UIDatePicker datePicker;
        UIButton OKButton;

        public DatePickerViewController () : base ()
        {
            ModalTransitionStyle = UIModalTransitionStyle.CrossDissolve;
        }

        public DatePickerViewController (IntPtr handle) : base (handle)
        {
        }

        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();
            View.BackgroundColor = A.Color_NachoGreen;

            datePicker = new UIDatePicker (new CGRect (0.0f, 101.0f, View.Bounds.Width, 162.0f));
            datePicker.AutoresizingMask = UIViewAutoresizing.FlexibleTopMargin | UIViewAutoresizing.FlexibleBottomMargin;
            View.AddSubview (datePicker);

            OKButton = new UIButton (UIButtonType.System);
            OKButton.SetTitleColor (UIColor.White, UIControlState.Normal);
            OKButton.SetTitle ("OK", UIControlState.Normal);
            OKButton.Frame = new CGRect (20.0f, datePicker.Frame.Y + datePicker.Frame.Height + 32.0f, 110.0f, 30.0f);
            OKButton.AutoresizingMask = UIViewAutoresizing.FlexibleTopMargin | UIViewAutoresizing.FlexibleBottomMargin;
            View.AddSubview (OKButton);

            cancelButton = new UIButton (UIButtonType.System);
            cancelButton.SetTitleColor (UIColor.White, UIControlState.Normal);
            cancelButton.SetTitle ("Cancel", UIControlState.Normal);
            cancelButton.Frame = new CGRect (View.Bounds.Width - 20.0f - 100.0f, OKButton.Frame.Y, 110.0f, 30.0f);
            cancelButton.AutoresizingMask = UIViewAutoresizing.FlexibleTopMargin | UIViewAutoresizing.FlexibleBottomMargin;
            View.AddSubview (cancelButton);

            datePicker.Mode = UIDatePickerMode.Date;
            datePicker.TintAdjustmentMode = UIViewTintAdjustmentMode.Dimmed;
            datePicker.BackgroundColor = UIColor.White;
            datePicker.Alpha = (nfloat)0.4;
            datePicker.AccessibilityLabel = "Pick deadline date";
            datePicker.HorizontalAlignment = UIControlContentHorizontalAlignment.Center;

            OKButton.HorizontalAlignment = UIControlContentHorizontalAlignment.Center;
            OKButton.TintColor = UIColor.White;
            OKButton.AccessibilityLabel = "Ok";
            OKButton.TouchUpInside += (object sender, EventArgs e) => {
                var date = datePicker.Date.ToDateTime ();
                var dateTime = DateTime.SpecifyKind (date, DateTimeKind.Utc);
                owner.DismissDatePicker (this, dateTime);
            };

            cancelButton.HorizontalAlignment = UIControlContentHorizontalAlignment.Center;
            cancelButton.TouchUpInside += (object sender, EventArgs e) => {
                DismissViewController (true, null);
            };
            cancelButton.TintColor = UIColor.White;
            cancelButton.AccessibilityLabel = "Cancel";
        }

        public override void ViewWillAppear (bool animated)
        {
            base.ViewWillAppear (animated);
            if (null != this.NavigationController) {
                this.NavigationController.ToolbarHidden = true;
            }
        }
    }
}
