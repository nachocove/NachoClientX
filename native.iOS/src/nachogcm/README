Needs a recent version of openssl (1.0.1j was used to write and test this code).
